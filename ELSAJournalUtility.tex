%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Copyright (c) 2022 Kuan-Yu Chang
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Public License.
% 
% The latest version of this file can be found at:
%     https://github.com/elsa-lab/ELSAJournalUtility
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Require Packages
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{changepage}
\usepackage{datetime}
\usepackage{tabularx}
\usepackage{xcolor}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Cover Letter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Base

\newenvironment{base_cover_letter}[3]{
    \begin{titlepage}
    \def\paperTitle{#1}
    \def\journalName{#2}
    \def\authorName{#3}
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{1.5em}
    \fontsize{10pt}{12pt}\selectfont
    
    \begin{center}
        \LARGE \textbf{Cover Letter}
    \end{center}
    
    \bigskip
}{

    Sincerely, \\
    \authorName{}
    \end{titlepage}
}

% Anonymous

\newenvironment{anonymous_cover_letter}[3]{
    \begin{base_cover_letter}{#1}{#2}
        {Authors of #3}

    Dear Editors and Reviewers,

}{\end{base_cover_letter}}

% Normal

\newenvironment{cover_letter}[6]{
    \begin{base_cover_letter}{#1}{#2}{#3}
    \newdate{letterDate}{#5}{#4}{#6}
    
    \begin{table}[h]
        \fontsize{10pt}{12pt}\selectfont
        \begin{tabularx}{\linewidth}{lX}
            \textbf{Authors:} \\
                & \authorName{} \\
            \textbf{Address:} \\
                & Department of Computer Science, \\
                & National Tsing Hua University, \\
                & Hsinchu City 30013, \\
                & Taiwan \\
            \textbf{Phone:} \\
                & +886-3-5731308 \\
            \textbf{Email:} \\
                & cylee@cs.nthu.edu.tw
        \end{tabularx}
    \end{table}
    
    \hfill \usdate\displaydate{letterDate}
    
    Dear Editors and Reviewers,

}{\end{base_cover_letter}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Revision Highlighting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Color definition

\AtBeginDocument{\colorlet{defaultcolor}{.}}
\newcommand{\todocolor}{orange}
\newcommand{\fixgrammarcolor}{brown}
\newcommand{\revisioncolor}{red}
\newcommand{\additioncolor}{blue}

% Commands to enable highlighting

\newcommand{\todotext}[1]{
    \color{\todocolor} [TODO] [#1] \color{defaultcolor}}
\newcommand{\todo}{
    \color{\todocolor} [TODO] \color{defaultcolor}}
\newcommand{\fixgrammar}[1]{
    \color{\fixgrammarcolor} #1 \color{defaultcolor}}
\newcommand{\revision}[1]{
    \color{\revisioncolor} #1 \color{defaultcolor}}
\newcommand{\addition}[1]{
    \color{\additioncolor} #1 \color{defaultcolor}}

% Command to disable all highlighting

\newcommand{\nohighlight}{
    \renewcommand{\todocolor}{defaultcolor}
    \renewcommand{\additioncolor}{defaultcolor}
    \renewcommand{\fixgrammarcolor}{defaultcolor}
    \renewcommand{\revisioncolor}{defaultcolor}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Responses to Reviewers
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\commenter}[1]{
    \section*{\underline{\makebox[\textwidth][l]{\Large #1}}}}

\newenvironment{reviewer_comment}{
    \bigskip
    \subsubsection*{
        \textbf{\textit{\underline{Comments to the Author}}}}
    \begin{adjustwidth}{1cm}{}
    \bfseries\itshape
}{\end{adjustwidth}}

\newenvironment{author_response}{
    \bigskip
    \textbf{Response:}}{}

